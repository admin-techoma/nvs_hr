<form class="d-flex flex-wrap" method="post" action="{% url 'hr:edit_resume' resume.candidate_id %}" enctype="multipart/form-data">
    {% csrf_token %}  
    <div class=" col-6 p-2 mb-1">
        <label for="id_name" class="form-label mb-0 mb-0">Candidate Name</label>
        {{form.name}}
    </div>
    <div class=" col-6 p-2 mb-1">
        <label for="id_email" class="form-label mb-0 mb-0">Email</label>
        {{ form.email }}
        <span id="email-error" class="text-danger"></span>
    </div>
    <div class=" col-6 p-2 mb-1">
        <label for="id_phone_number" class="form-label mb-0 mb-0">Mobile Number</label>
        {% comment %} <input autocomplete="off" type="tel"  class="form-control form-control-sm"  name="phone_number" value="{{form.phone_number}}" id="id_phone_number" autocomplete="off" pattern="[0-9]{10}" maxlength="10" minlength="10" required> {% endcomment %}
        {{ form.phone_number }} 
        <span id="contact_no-error" class="text-danger"></span> 
    </div>
    <div class=" col-6 p-2 mb-1">
        <label for="id_remarks" class="form-label mb-0 mb-0">Remarks</label>
        {{ form.remarks }}
    </div>
    
    <div class=" col-6 p-2 mb-1">
        <label for="resumeFile" class="form-label mb-0 mb-0">Choose File</label>
        <input type="file" name="resume" id="resumeFile" class="form-control-file form-control-sm">
    </div>
    
    <div class=" col-6 p-2 mb-1">
        <label for="id_status" class="form-label mb-0 mb-0">Resume Status</label>
        {{form.status}}
    </div>
    <div class="col-12">
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Close</button>
            <button class="btn custom-button btn-sm" type="submit" >Save</button>
        </div>
    </div>
</form>

{% if form.errors %}
<ul>
    {% for error in form.errors %}
        <li>{{ error }}</li>
    {% endfor %}
</ul>
{% endif %}


    <script>
        $(document).ready(function() {
            function checkEmailExists() {
                var email = $('#id_email').val(); // Adjust the ID based on your form field
                if (email) {
                    $.ajax({
                        type: 'GET',
                        url: '{% url "hr:check_email_exists" %}',
                        data: {'email': email},
                        success: function(response) {
                            if (response.candidate_exists) {
                                $('#email-error').text('Email already exists.');
                            } else {
                                $('#email-error').text('');
                            }
                        },
                        error: function() {
                            $('#email-error').text('Error checking email existence.');
                        }
                    });
                } else {
                    $('#email-error').text('');
                }
            }
    
            function checkContactNoExists() {
                var phone_number_exists = $('#id_phone_number').val(); // Adjust the ID based on your form field
                if (phone_number_exists) {
                    $.ajax({
                        type: 'GET',
                        url: '{% url "hr:check_contact_no_exists" %}',
                        data: {'phone_number': phone_number_exists}, // Include both contact_no and phone_number
                        success: function(response) {
                            if (response.contact_no_exists) {
                                $('#contact_no-error').text('Contact No already exists.');
                            } else {
                                $('#contact_no-error').text('');
                            }
                            if (response.phone_number_exists) {
                                $('#contact_no-error').text('Phone number already exists.');
                            } else {
                                $('#contact_no-error').text('');
                            }
                        },
                        error: function() {
                            $('#contact_no-error').text('Error checking contact number existence.');
                        }
                    });
                } else {
                    $('#contact_no-error').text('');
                }
            }
    
            $('#id_email').on('change', function() {
                checkEmailExists();
            });
    
            $('#id_phone_number').on('change', function() {
                checkContactNoExists();
            });
        });
</script>